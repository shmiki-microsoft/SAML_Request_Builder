<!DOCTYPE html>
<html lang="en">
<%- include('common/head') %>
<body>
    <%- include('common/navbar') %>
    <div class="container">
        <h1>Generate SAML Request Advanced</h1>
        <form action="/generateAdvancedSamlRequest" method="post">
            <fieldset>
                <legend>SAML Request Details</legend>
                
                <!-- SAML Request XML -->
                <label for="samlRequestXml">SAML Request XML:</label>
                <p>Please modify the displayed sample as needed.</p>
                <textarea id="samlRequestXml" name="samlRequestXml" placeholder="Paste your SAML Request XML here" required><%= samlRequestXml ? samlRequestXml : `
<?xml version="1.0"?>
<AuthnRequest 
    xmlns="urn:oasis:names:tc:SAML:2.0:protocol"
    xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion" 
    Version="2.0" ID="_14a55139c6d6a8e89640c9e348e64921b16f684608"
    IssueInstant="2024-08-16T10:00:42.285Z"
    Destination="https://idp.example.com/saml2"
    AssertionConsumerServiceURL="http://sp.example.com/acs"
    ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST"
    ForceAuthn="false">
    <saml:Issuer>sp.example.com</saml:Issuer>
    <NameIDPolicy Format="urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress" AllowCreate="true"/>
</AuthnRequest>` %></textarea>

                <!-- RelayState -->
                <label for="relayState">RelayState:</label>
                <input type="text" id="relayState" name="relayState" placeholder="Enter RelayState" value="<%= relayState ? relayState : '' %>">

                <!-- Submit Button -->
                <button type="submit">Generate SAML Request</button>
            </fieldset>
        </form>
        
        <% if (samlRequestEncodedUrl) { %>
            <h2>Encoded SAML Request</h2>
            <textarea readonly rows="20" id="encodedSamlRequest" name="encodedSamlRequest"><%= samlRequestEncodedUrl %></textarea>
            <button type="submit" id="sendRequestButton" data-login-url="<%= samlRequestEncodedUrl %>">Send SAML Request</button>
            <script src="SendSamlRequest.js"></script>
        <% } %>
    </div>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<%- include('common/head') %>
<body>
    <%- include("common/navbar") %>
    <div class="container">
        <h1>Generate SAML Request</h1>
        <form action="/generateSamlRequest" method="POST">
            <fieldset>
                <legend>SAML Request Details</legend>
                
                <!-- Issuer (EntityID) -->
                <label for="issuer">Issuer (EntityID):</label>
                <input type="text" id="issuer" name="issuer" placeholder="Enter the Issuer (EntityID)" value="<% if (issuer) { %><%= issuer %><% } %>" required>
                <small>Example: sp.example.com</small>
                
                <!-- Destination (IdP SSO URL) -->
                <label for="destination">Destination (IdP SSO URL):</label>
                <input type="text" id="destination" name="destination" placeholder="Enter the IdP SSO URL" value="<% if (destination) { %><%= destination %><% } %>" required>
                <small>Example: https://idp.example.com/sso</small>
                
                <!-- Assertion Consumer Service URL (optional) -->
                <label for="assertionConsumerServiceURL">Assertion Consumer Service URL (optional):</label>
                <input type="text" id="assertionConsumerServiceURL" name="assertionConsumerServiceURL" placeholder="Enter the Assertion Consumer Service URL" value="<% if (assertionConsumerServiceURL) { %><%= assertionConsumerServiceURL %><% } %>">
                <small>Example: http://sp.example.com/acs</small>
                
                <!-- NameID Format -->
                <label for="nameIDFormat">NameID Format:</label>
                <select id="nameIDFormat" name="nameIDFormat" required>
                    <option value="urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress" <%= nameIDFormat === 'urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress' ? 'selected' : '' %>>Email Address</option>
                    <option value="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" <%= nameIDFormat === 'urn:oasis:names:tc:SAML:2.0:nameid-format:persistent' ? 'selected' : '' %>>Persistent</option>
                    <option value="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" <%= nameIDFormat === 'urn:oasis:names:tc:SAML:2.0:nameid-format:transient' ? 'selected' : '' %>>Transient</option>
                    <option value="urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified" <%= nameIDFormat === 'urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified' ? 'selected' : '' %>>Unspecified</option>
                </select>
                <small>Select the NameID Format</small>
 
                <!-- Auth Context (optional) -->
                <!-- <label for="authContext">Auth Context (optional):</label>
                <select id="authContext" name="authContext">
                    <option value="">--Select Auth Context--</option>
                    <option value="urn:oasis:names:tc:SAML:2.0:ac:classes:InternetProtocol">Internet Protocol</option>
                    <option value="urn:oasis:names:tc:SAML:2.0:ac:classes:Password">Password</option>
                    <option value="urn:oasis:names:tc:SAML:2.0:ac:classes:Kerberos">Kerberos</option>
                    <option value="urn:oasis:names:tc:SAML:2.0:ac:classes:X509">X.509</option>
                </select> -->
                
                <!-- Allow Unencrypted Assertion -->
                <!-- <label for="allowUnencryptedAssertion">Allow Unencrypted Assertion:</label>
                <select id="allowUnencryptedAssertion" name="allowUnencryptedAssertion">
                    <option value="true">true</option>
                    <option value="false">false</option>
                </select> -->                

                <!-- Force Authn -->
                <label for="forceAuthn">Force Authn:</label>
                <select id="forceAuthn" name="forceAuthn">
                    <option value="true" <%= forceAuthn === 'true' ? 'selected' : '' %>>true</option>
                    <option value="false" <%= forceAuthn === 'false' ? 'selected' : '' %>>false</option>
                </select>
                <small>Force the user to authenticate again</small>
                
                <!-- RelayState -->
                <label for="relayState">RelayState (optional):</label>
                <input type="text" id="relayState" name="relayState" placeholder="Enter RelayState" value="<% if (relayState) { %><%= relayState %><% } %>">
                <small>Example: Some state information</small>

                <!-- Binding -->
                <!-- <label for="binding">Binding:</label>
                <select id="binding" name="binding">
                    <option value="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST">HTTP-POST</option>
                    <option value="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect">HTTP-Redirect</option>
                </select>
                 -->
                <!-- Submit Button -->
                <button type="submit">Generate SAML Request</button>
            </fieldset>      

        </form>      
        <% if (samlRequest) { %>
        <h2>Generated SAML Request</h2>
        <textarea readonly rows="20" placeholder="Generated SAML Request"><%= samlRequest %></textarea>
        <h2>RelayState</h2>
        <input type="text" id="relayState" name="relayState" readonly value="<% if (issuer) { %><%= relayState %><% } %>">
        <button type="submit" id="sendRequestButton" data-login-url="<%= samlRequestEncodedUrl %>">Send SAML Request</button>
        <% } %>
    </div>
    <script src="SendSamlRequest.js"></script>
</body>
</html>